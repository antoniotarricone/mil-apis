@startuml
!include_many ../common/skin.puml
!include_many ../common/actors.puml

group pre-save
	AG -> IWS : POST /cards
		rnote left
			__header__
			- Version: //<api version>//
			- AcquirerId: //<acquirer id>//
			- Channel: //<channel>//
			- TerminalId: //<terminal id>//
			- SessionId: //<session id>//
			__request body__
			{
				"panToken": "//<pan token>//"
			}
		end note
	
	!$client = IWS
	!include_many ../session/check.puml
	
	IWS -> WS : POST /cards
		rnote left
			__header__
			- Version: //<api version>//
			
			__request body__
			{
				"panToken": "//<pan token>//",
				"taxCode": "//<tax code>//"
			}
		end note
	
	WS --> IWS : HTTP __not__ 201
	
	IWS --> AG : HTTP 500 (server error)
end
@enduml